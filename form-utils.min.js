function initMasks(){document.querySelectorAll("input[mask]").forEach((t=>{const e=t.getAttribute("mask");t.addEventListener("input",(t=>{const a=t.target.value;let n="",i=0;for(let t=0;t<e.length&&i<a.length;t++){const r=e[t],o=a[i];"9"===r?(/\d/.test(o)?n+=o:t--,i++):"A"===r?(/[a-zA-Z]/.test(o)?n+=o:t--,i++):"*"===r?(n+=o,i++):(n+=r,o===r&&i++)}t.target.value=n}))}))}function initCaseTransform(){Object.entries({lowercase:t=>t.toLowerCase(),uppercase:t=>t.toUpperCase(),capitalize:t=>t.replace(/\b\w/g,(t=>t.toUpperCase()))}).forEach((([t,e])=>{document.querySelectorAll(`input[${t}],textarea[${t}]`).forEach((t=>{t.addEventListener("input",(()=>{t.value=e(t.value)}))}))}))}function initFilePreviews(){document.querySelectorAll('input[type="file"]').forEach((t=>{const e=document.createElement("div");e.className="file-preview",e.style.marginTop="4px";const a=document.createElement("div");a.style.marginTop="4px",a.appendChild(e),t.parentNode.insertBefore(a,t.nextSibling),t.addEventListener("change",(()=>{e.innerHTML="",Array.from(t.files).forEach((t=>{const a=t.type.startsWith("image/"),n=t.type.startsWith("video/");if(!a&&!n)return;const i=document.createElement(a?"img":"video");i.src=URL.createObjectURL(t),i.style.cssText=`max-width:${a?200:300}px;max-height:200px;margin-top:4px`,n&&(i.controls=!0),i[a?"onload":"onloadeddata"]=()=>URL.revokeObjectURL(i.src),e.appendChild(i)}))}))}))}function initFloatFields(){document.querySelectorAll("input[float]:not([data-float-initialized])").forEach((t=>{const e=t.hasAttribute("min")?parseFloat(t.getAttribute("min")):null,a=t.hasAttribute("max")?parseFloat(t.getAttribute("max")):null,n=t=>t.toFixed(2).replace(".",",").replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1.");t.type="text",t.addEventListener("input",(t=>{const e=t.target.value.replace(/\D/g,"");if(!e)return void(t.target.value="");let i=parseFloat(e)/100;null!==a&&i>a&&(i=a),t.target.value=n(i)})),t.addEventListener("blur",(t=>{if(!t.target.value)return;const a=parseFloat(t.target.value.replace(/\./g,"").replace(",","."))||0;null!==e&&a<e&&(t.target.value=n(e))})),t.dataset.floatInitialized="true"}))}function initCopyableFields(){document.querySelectorAll("input[copyable]:not([data-copyable-initialized]),textarea[copyable]:not([data-copyable-initialized])").forEach((t=>{const[e,a="Copied!"]=(t.getAttribute("copyable-text")||"Copy;Copied!").split(";"),n=Object.assign(document.createElement("button"),{type:"button",textContent:e});applyMutedStyle(n),getOrCreateActionBar(t).appendChild(n),n.addEventListener("click",(async()=>{try{await navigator.clipboard.writeText(t.value),n.textContent=a,setTimeout((()=>{n.textContent=e}),1e3)}catch(t){console.error("Copy failed",t)}})),t.dataset.copyableInitialized="true"}))}function initPasswordHelpers(){document.querySelectorAll('input[type="password"]:not([data-password-initialized])').forEach((t=>{const[e,a="Hide"]=(t.getAttribute("password-text")||"Show;Hide").split(";"),n=Object.assign(document.createElement("button"),{type:"button",textContent:e});applyMutedStyle(n);const i=getOrCreateActionBar(t);i.appendChild(n);let r=!1;if(n.addEventListener("click",(()=>{r=!r,t.type=r?"text":"password",n.textContent=r?a:e})),t.hasAttribute("strength")){const e=(t.getAttribute("strength-messages")||"Weak;Medium;Strong;Very Strong").split(";").map((t=>t.trim())),a=["#dc3545","#ffc107","#17a2b8","#28a745"],n=Object.assign(document.createElement("span"),{style:"font-size:0.75rem"});applyMutedStyle(n),i.appendChild(n),t.addEventListener("input",(()=>{const i=t.value,r=i.length>=8&&/[A-Z]/.test(i)&&/\d/.test(i)&&/[^A-Za-z0-9]/.test(i)?3:i.length>=6&&(/[A-Z]/.test(i)&&/\d/.test(i)||/[A-Z]/.test(i)&&/[^A-Za-z0-9]/.test(i))?2:i.length>=6?1:0;n.textContent=e[r],n.style.color=a[r]}))}t.dataset.passwordInitialized="true"}))}function initAutoTrim(){document.querySelectorAll("input, textarea").forEach((t=>{t.addEventListener("blur",(()=>{t.value=t.value.trim()}))}))}initMasks(),initCaseTransform(),initFilePreviews(),initFloatFields(),initCopyableFields(),initPasswordHelpers(),initAutoTrim();